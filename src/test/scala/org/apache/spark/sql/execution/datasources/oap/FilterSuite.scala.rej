diff a/src/test/scala/org/apache/spark/sql/execution/datasources/oap/FilterSuite.scala b/src/test/scala/org/apache/spark/sql/execution/datasources/oap/FilterSuite.scala	(rejected hunks)
@@ -30,18 +30,16 @@ import org.apache.spark.sql.internal.SQLConf
 import org.apache.spark.sql.test.SharedSQLContext
 import org.apache.spark.util.Utils
 
-
 class FilterSuite extends QueryTest with SharedSQLContext with BeforeAndAfterEach {
   import testImplicits._
 
   sparkConf.set("spark.memory.offHeap.size", "100m")
-  var currentPath: String = _
+  private var currentPath: String = _
 
   override def beforeEach(): Unit = {
     sqlContext.conf.setConf(SQLConf.OAP_IS_TESTING, true)
     val path = Utils.createTempDir().getAbsolutePath
     currentPath = path
-
     sql(s"""CREATE TEMPORARY VIEW oap_test (a INT, b STRING)
            | USING oap
            | OPTIONS (path '$path')""".stripMargin)
@@ -229,10 +276,17 @@ class FilterSuite extends QueryTest with SharedSQLContext with BeforeAndAfterEac
         |SELECT key from t where value == 4
       """.stripMargin)
 
+    sql(
+      """
+        |INSERT INTO TABLE t_refresh_parquet
+        |partition (b=1)
+        |SELECT key from t where value == 5
+      """.stripMargin)
+
     sql("refresh oindex on t_refresh_parquet")
 
     checkAnswer(sql("select * from t_refresh_parquet"),
-      Row(1, 1) :: Row(2, 1) :: Row(3, 1) :: Row(4, 2) :: Nil)
+      Row(1, 1) :: Row(2, 1) :: Row(3, 1) :: Row(5, 1) :: Row(4, 2) :: Nil)
   }
 
   test("test refresh in oap format on same partition") {
